<!DOCTYPE html>
<html>	
	<head>
		<title>Gravity phenomenon</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script type="text/javascript" src="Libraries/three/build/three.js"></script>
        <script type="text/javascript" src="Libraries/three/examples/js/controls/OrbitControls.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
        
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<style>
		  body{
		/* set margin to 0 and overflow to hidden, 
		to use the complete page */
		      margin: 0;
		      overflow: hidden;
		  }
          #gui { 
              position: absolute; 
              top: 2px; 
              left: 2px; 
            }
            @media only screen and (max-width: 768px) {
                #gui{
                    width: 100%;
                }
            }
		</style>
	</head>
	<body>
		<!--Div which will hold the Output -->
        
        <div id="WebGL-output">
        </div>
        
		<!--Javascript code that runs our Three.js examples -->
		<script type="text/javascript">
            
            const HEIGHT=window.innerHeight
            const WIDTH=window.innerWidth
            
            var g=0.001
            var STOP_TIME=-1
            time=0
		    var scene = new THREE.Scene();
            //window.addEventListener("wheel", onMouseWheel);
            
            
            
            //setting camera
            var camera = new THREE.PerspectiveCamera(100, WIDTH / HEIGHT, 0.1, 100000);
            camera.position.z = 200;
            

            var material =new THREE.MeshPhongMaterial({shininess:10, color: 0xffffff})
            
            
            var gui = new dat.gui.GUI();
            gui.domElement.id = 'gui';
            
            var objs=[]/*
                 new Objects([0,0,0], [0,0,0], [100000, 30], "1", "star"),
                 new Objects([100,0,0], [0,1,0], [100, 7], "2", "planet"),
                 new Objects([-100,0,0], [0,0.65,0.4], [100, 10], "3", "planet")    
                     ]   */
            
            //0;0;0;0;0;0;100000;30;#ffffff;Star;star---0;100;0;1;0;0;100;10;#418c00;Planet;planet---
            var objs_copy=[]
            
            var start_button;
            
            var setting={
                start:false,
                G:0.001,
                light_general:"#ff0000",
                general_light:new THREE.AmbientLight(0x418c00),
                ok: function(){
                    g=this.G
                    this.general_light.color=new THREE.Color(this.light_general); // soft white light
                },
                starter:function(){
                    if(this.start){
                        start_button.name("Start")
                    }else{
                        time+=1
                        start_button.name("Stop")
                        gui.close()
                        
                    }
                    this.start=!this.start
                },
                reloader:function(){
                    objs=objs_copy
                }
            }
            
            start_button=gui.add(setting, 'starter').name("Start")
            //gui.add(setting, 'reloader').name("Reload")
            
            scene.add(setting.general_light);
            
            
            class Objects{
                constructor(coord, velocity,  params, name, objType){
                    
                    this.coord=coord
                    this.coord_=coord
                    this.velocity=velocity
                    this.velocity_=velocity
                    this.accel=[0,0,0];
                    this.params=params
                    this.name=name
                    
                    this.points=[]
                    this.toTrace=false    
                    var materialLine = new THREE.LineBasicMaterial({color: new THREE.Color(setting.general_light)});
                    var geometryLine = new THREE.BufferGeometry().setFromPoints( this.points );
                    this.line = new THREE.Line( geometryLine, materialLine );
                    scene.add(this.line);
                    
                    this.data=gui.addFolder(name)
                    this.data.add(params, 0).name("Mass")
                    this.data.add(this, 'toTrace', [true, false]).name("Trace")
                    var coods=[this.data.add(coord, 0), this.data.add(coord, 1), this.data.add(coord, 2)]
                    for(var i=0; i<3; i++){
                    coods[i].domElement.style.pointerEvents = "none"
                    coods[i].listen()
                    }
                    coods[0].name("X")
                    coods[1].name("Y")
                    coods[2].name("Z")
                    var vels=[this.data.add(velocity, 0), this.data.add(velocity, 1), this.data.add(velocity, 2)]
                    for(var i=0; i<3; i++){
                    vels[i].domElement.style.pointerEvents = "none"
                    vels[i].listen()
                    }
                    vels[0].name("VelocityX")
                    vels[1].name("VelocityY")
                    vels[2].name("VelocityZ")
                    
                    
                    
                    this.objType=objType
                    if(objType=="planet"){
                        this.generatePlanet()
                    }
                    if(objType=="star"){
                        this.generateStar()
                    }
                    
                        
                }
                generatePlanet(){
                    var geometry = new THREE.SphereGeometry( this.params[1], 32, 32 );
                    this.obj = new THREE.Mesh( geometry, new THREE.MeshLambertMaterial({shininess:1200, color: new THREE.Color(this.params[2])})); 
                    scene.add( this.obj ); 
                }
                generateStar(){
                    var geometry = new THREE.SphereGeometry( this.params[1], 32, 32 );
                    this.obj = new THREE.Mesh( geometry, new THREE.MeshLambertMaterial({emissive:new THREE.Color(this.params[2])})); 
                    scene.add(this.obj);   
                }
                
                confirm(){
//                    if(this.objType=="star"){
//                        this.point_light.position.set(this.coord[0], this.coord[1], this.coord[2])
//                    }
                }
            }
            
            var settings=gui.addFolder('Settings')
            settings.addColor(setting, 'light_general')
            settings.add(setting, 'G')
            settings.add(setting, 'ok')
            
            
            
            var conv=gui.addFolder("Convert")
            
            
            var adding=gui.addFolder("Add")
            
            convInfo={
                str:"210?-135.00905207913144;1121.236760991361;2.476439376838081;0.5750082584544269;-4.664564550717482;-0.01380696833272993;1000;1;#4220ff;0;star---16.37073179226251;1019.2701420004253;104.81697830013358;-0.0696677901022586;-4.256918140013035;-0.4928444043874963;1000;1;#4220ff;1;star---198.22447989777808;1077.0827473782247;-217.4311540499348;-0.8692003820978916;-4.4834915920473835;1.03702965392933;1000;1;#4220ff;2;star---375.00112706414006;1043.9978527368169;-244.2960106816414;-1.6146595969328426;-4.34819037388845;1.1683725861840846;1000;1;#4220ff;3;star---511.7317614153992;936.5951453763472;-492.39999660883825;-2.214582602155464;-3.9030394111226694;2.3430527591769357;1000;1;#4220ff;4;star---617.873931818002;818.9431924271364;-253.79475317319518;-2.6685984276018546;-3.4164858627194183;1.2150526176127343;1000;1;#4220ff;5;star---758.0745652212798;675.0612731484201;753.4035954772221;-3.29119297353626;-2.798921792657677;-3.5993226013761586;1000;1;#4220ff;6;star---858.2363016996952;549.8367021093211;806.3409884825471;-3.7085885935657674;-2.3019971922982325;-3.8473450096101502;1000;1;#4220ff;7;star---1023.1308483859076;395.559699152821;-899.3164537346971;-4.439685054274232;-1.6307662319097442;4.290749831991821;1000;1;#4220ff;8;star---1163.224671000593;283.8195379897171;-819.6402855073044;-5.03076112803962;-1.1799557010694965;3.9172890343904103;1000;1;#4220ff;9;star---1348.297822640977;204.4297032568936;-1186.378112582116;-5.835200095783019;-0.8506257985766662;5.663749378091206;1000;1;#4220ff;10;star---1517.5281101458315;145.30349945652506;1456.0411416967504;-6.575636325416348;-0.6038841788744425;-6.960749039490966;1000;1;#4220ff;11;star---1450.7381200285204;46.618084213411855;-466.0347752503048;-6.252598950213294;-0.16919787606100586;2.233974913183174;1000;1;#4220ff;12;star---1357.7692392663173;-30.626176301463506;-500.4418286570694;-5.87890764186231;0.1271046122536915;2.3935282863160405;1000;1;#4220ff;13;star---1233.5666238640672;-136.68522231366634;-622.2968861975137;-5.341059177851886;0.5662893140275382;2.963303280134077;1000;1;#4220ff;14;star---1049.2197699417857;-198.0166114892227;-442.5669855807336;-4.543937304355229;0.8194091355501263;2.1150151819172462;1000;1;#4220ff;15;star----426.2640809840464;1046.7370408132922;173.3407119056574;1.8396183295291184;-4.363528510397856;-0.8239305457148196;1000;1;#4220ff;16;star----573.0634228725246;883.00751998378;-431.9693873029938;2.486960374369074;-3.674678783515186;2.0604077275854373;1000;1;#4220ff;17;star----747.2285972824145;747.7641793799597;-417.91044012370713;3.230684907046454;-3.1183451326751856;1.9932173576076544;1000;1;#4220ff;18;star----924.3808918867236;575.0618933274021;-43.693718185386906;4.005491079024762;-2.387954421240992;0.21005885674926392;1000;1;#4220ff;19;star----1103.86042383886;499.1603265615523;141.62821720529408;4.771788866617456;-2.079359605438243;-0.6674530746962356;1000;1;#4220ff;20;star----1268.4098126913098;462.1470264343734;-366.69629561866407;5.478288449590934;-1.904317646912628;1.7524692974265972;1000;1;#4220ff;21;star----1237.5809648093714;318.665470500291;-399.34234893024956;5.345587041175084;-1.32567997559753;1.912531637116789;1000;1;#4220ff;22;star----1186.6997105006465;226.9967628177584;-481.6791284286466;5.143743413964518;-0.9723879842666724;2.28852006864582;1000;1;#4220ff;23;star----1011.9548136499701;60.9386436610924;104.74760858266191;4.369769646148352;-0.2587374019900069;-0.4960963532695018;1000;1;#4220ff;24;star----788.9067004381395;235.1578646513555;-209.65337779743172;3.4075328519504606;-0.9726273265042001;1.0004717235562546;1000;1;#4220ff;25;star----528.4745733597454;345.51419456789046;177.2391635786588;2.282893347586005;-1.4336437055884863;-0.8395940068721633;1000;1;#4220ff;26;star----230.02560793234784;397.1555480988525;156.29772025515393;0.988931883831246;-1.640773202769074;-0.738290723649132;1000;1;#4220ff;27;star---103.9533358984757;406.345929547984;75.79217883897142;-0.45604039761206755;-1.6715145110002376;-0.3588291550182838;1000;1;#4220ff;28;star---381.22664604975654;358.98291293520776;188.32544743194876;-1.6495374937909117;-1.4734007279744648;-0.8880050988168039;1000;1;#4220ff;29;star---608.7343155623346;280.66426077190766;-101.61004627042658;-2.625768704916716;-1.1417106275628675;0.4815132807341028;1000;1;#4220ff;30;star---738.5073619148935;155.24320794260618;-703.868424357678;-3.2022657009523017;-0.6361964482157015;3.3516870158679644;1000;1;#4220ff;31;star---860.1597442039787;53.011255831513246;-384.8224183669448;-3.7148234638655677;-0.21348615554332132;1.8355146232592046;1000;1;#4220ff;32;star----157.89430814032337;258.9901412905393;-76.4897976820069;0.672553075924484;-1.0781846885625241;0.358551339206692;1000;1;#4220ff;33;star---101.41787920314685;129.48752242786608;61.2665242613971;-0.47457180254607945;-0.5202594713021823;-0.27725739692932716;1000;1;#4220ff;34;star---260.63885381045577;61.342331455038064;-24.185690293344177;-1.1138142450297441;-0.17470964094239338;0.12767194865944193;1000;1;#4220ff;35;star---201.40721022319053;37.858365464029724;-58.83297206840479;-0.9574711235819323;-0.17133576074782778;0.24888864310142897;1000;1;#4220ff;36;star---271.67452509032506;0.33594828439806945;-23.4929281320957;-1.1696867962858857;-0.09036007926015298;0.1254011148182118;1000;1;#4220ff;37;star---439.77905438739157;59.14546416849522;-15.287072703021781;-1.8935475424839907;-0.22129452135358313;0.0701454845321502;1000;1;#4220ff;38;star---396.51704176025737;-31.17507945492389;-292.9922674637926;-1.7202373323663311;0.11543890050178032;1.3737692866361875;1000;1;#4220ff;39;star---618.0675274401035;52.182896736452406;82.9466962143727;-2.6336617699015057;-0.193035580895883;-0.3928082251183352;1000;1;#4220ff;40;star----636.2555222163589;140.7075664345448;-399.8199303328261;2.7587942671128087;-0.5838619318151002;1.8979746516425204;1000;1;#4220ff;41;star----642.3963771925468;1.00423484483792;-26.044800568610427;2.7807327301399356;-0.006026927161432211;0.12973488517977536;1000;1;#4220ff;42;star----596.8729649329262;-174.83184307277875;-284.84483875322906;2.577323830674328;0.7294806935237269;1.3575422824599357;1000;1;#4220ff;43;star----372.36180367658943;-508.46172006213146;303.9441402849278;1.607251270706686;2.106917106604833;-1.4405873589184717;1000;1;#4220ff;44;star----253.21189130687196;-631.8792906350361;-74.71915841132106;1.0864550635574577;2.6168879311613344;0.35073187320171956;1000;1;#4220ff;45;star----32.564252172591374;-717.1161671114277;14.805050940243651;0.14044100586918096;2.9676582614217537;-0.06822650999413263;1000;1;#4220ff;46;star---265.29980154141265;-662.6562911228178;-149.853180867834;-1.1519281284329088;2.7363308904538384;0.7091970386492863;1000;1;#4220ff;47;star---559.205839310883;-336.06585281851426;112.00513779168051;-2.438902595920677;1.4172259782528736;-0.49902644382795386;1000;1;#4220ff;48;star---645.3082918221509;-115.26131177133212;-156.4900059364165;-2.7816074454498043;0.4667015393700744;0.7388308480178631;1000;1;#4220ff;49;star---400.7671324541509;-504.3111620562117;-42.1598493892366;-1.7403794179000063;2.0806724241168117;0.20071755154455126;1000;1;#4220ff;50;star----1072.4677847198793;-393.3126087981497;455.959022151944;4.632926465452563;1.634787992975113;-2.175644157287276;1000;1;#4220ff;51;star----904.7397112577912;-391.1700211660182;25.86827264288963;3.9072748794767826;1.6213877224992201;-0.12528191239490083;1000;1;#4220ff;52;star----730.3741898172842;-403.3744272607645;710.9007335408116;3.1608240888628574;1.6756245514907107;-3.3902188799998605;1000;1;#4220ff;53;star----509.7808729609151;-407.26679913275007;54.072948688200775;2.19827434109655;1.6894911531944754;-0.25798509842543255;1000;1;#4220ff;54;star----519.5657100663148;-293.62927281159347;-438.5693789510777;2.253151002934615;1.211603807368318;2.0813502697302524;1000;1;#4220ff;55;star----139.72100175936356;-409.10297309887136;140.317955249045;0.6018181872018428;1.7056746760937422;-0.6640665594698664;1000;1;#4220ff;56;star---128.47950671273657;-422.43446239279103;-56.891066235926054;-0.5654711036814342;1.755208075829504;0.2696013581435983;1000;1;#4220ff;57;star---584.7592905833745;-366.8772889748915;25.145437643469236;-2.519145085288268;1.482958262819884;-0.14478864942278258;1000;1;#4220ff;58;star---824.6899071825687;-385.42645633720537;-619.2579792612019;-3.575274791230173;1.5950614968705463;2.9492488263837537;1000;1;#4220ff;59;star---1041.9575653863492;-404.3868226014149;864.5647319079898;-4.513417282226145;1.6868906303986484;-4.123345247800344;1000;1;#4220ff;60;star---1336.861333478294;-394.5284300387981;-680.684650309075;-5.7810790825995095;1.634818459933773;3.2458633584836316;1000;1;#4220ff;61;star---1618.8376517469833;-396.07023625636583;423.49188650283736;-7.01395213094005;1.6512653973020528;-2.0209719758251454;1000;1;#4220ff;62;star---1064.4729797006503;-508.89176936913566;470.15191181819756;-4.607603881649345;2.1069105649328437;-2.24281195731448;1000;1;#4220ff;63;star---1279.0663818347975;-462.32783966555326;-243.1055668448147;-5.534926680506702;1.9134646286120613;1.1650072341000124;1000;1;#4220ff;64;star---795.7638535255968;-481.49229398257467;84.2666521055213;-3.4336670316524063;1.981780236981063;-0.398201296727871;1000;1;#4220ff;65;star---1903.064883135648;-408.9571901876638;328.7005839350131;-8.238350621970557;1.7064018339417117;-1.5716764805248302;1000;1;#4220ff;66;star----813.9293293559323;-15.810372450159582;711.2582203429802;3.5206611964212144;0.06649535554784186;-3.3915118146196566;1000;1;#4220ff;67;star---910.2816554818969;-68.42373605474177;459.6603439439465;-3.9334456697553333;0.2865716657070511;-2.18608286266679;1000;1;#4220ff;68;star---537.3688566911086;9.572161257371363;161.05251008916025;-2.329174112321363;-0.05839121243218158;-0.7359980349165067;1000;1;#4220ff;69;star---",
                f:function(){
                    str_time=this.str.split('?')
                    STOP_TIME=parseInt(str_time[0])
                    objects_str=str_time[1].split('---')
                    for(i=0; i<objects_str.length-1; i++){
                        console.log(objects_str[i])
                        var chars=objects_str[i].split(';')
                        objs.push(new Objects(
                        [parseFloat(chars[0]), parseFloat(chars[1]), parseFloat(chars[2])],
                        [parseFloat(chars[3]), parseFloat(chars[4]), parseFloat(chars[5])],
                        [parseFloat(chars[6]), parseFloat(chars[7]),  chars[8]],
                        chars[9],
                        chars[10]
                        ))
                        console.log(chars[10])
                    }
                },
                p:function(){
                    this.str="-1?"
                    for(i=0;i<objs.length; i++){
                        this.str+=objs[i].coord[0]+";"+objs[i].coord[1]+";"+objs[i].coord[2]+";"+
                            (-objs[i].velocity[0])+";"+(-objs[i].velocity[1])+";"+(-objs[i].velocity[2])+";"+
                            objs[i].params[0]+";"+objs[i].params[1]+";"+objs[i].params[2]+";"+objs[i].name+";"+objs[i].objType+"---"
                    }
                }
            }
            convInfo.f()
            var strs=conv.add(convInfo, 'str')
            strs.name("G Code")
            strs.listen()
            conv.add(convInfo, 'f').name("Unparse")
            conv.add(convInfo, 'p').name("Parse")
            
            infoToAdd ={
                name: "planet X",
                objtype: "planet",
                colort: "#303030",
                mass: 100,
                radius: 10,
                x: 0,
                y: 0,
                z: 0,
                velx: 0,
                vely: 0,
                velz: 0,
                
            }
            adding.add(infoToAdd, 'name').name("Name")
            adding.add(infoToAdd, 'objtype', ['planet', 'star']).name("Type")
            adding.addColor(infoToAdd, 'colort').name("Color")
            adding.add(infoToAdd, 'mass').name("Mass")
            adding.add(infoToAdd, 'radius').name("Radius")
            adding.add(infoToAdd, 'x').name("X")
            adding.add(infoToAdd, 'y').name("Y")
            adding.add(infoToAdd, 'z').name("Z")
            adding.add(infoToAdd, 'velx').name("Velocity X")
            adding.add(infoToAdd, 'vely').name("Velocity Y")
            adding.add(infoToAdd, 'velz').name("Velocity Z")
            
            
            
            adding.add([addObject], 0).name("add")
            function addObject(){
                objs.push(new Objects([infoToAdd.x, infoToAdd.y, infoToAdd.z], [infoToAdd.velx, infoToAdd.vely, infoToAdd.velz], [infoToAdd.mass, infoToAdd.radius, infoToAdd.colort], infoToAdd.name, infoToAdd.objtype))
                
            }
            
            function confirm(objects){
                for(i=0; i<objects.length; i++){
                    objects[i].coord_=objects[i].coord
                    objects[i].velocity_=objects[i].velocity
                    objects[i].accel=[0,0,0]
                    objects[i].confirm()
                }
            }
            
    
            
            var renderer = new THREE.WebGLRenderer(); 
            renderer.setSize( WIDTH, HEIGHT ); 
            document.body.appendChild( renderer.domElement );
            

            
            controls = new THREE.OrbitControls( camera, renderer.domElement );
            controls.rotateSpeed = 1.0;
            controls.zoomSpeed = 1.2;
            controls.panSpeed = 0.8;
            controls.noZoom = false;
            controls.noPan = false;
            controls.staticMoving = true;
            controls.dynamicDampingFactor = 0.0;

            
//            console.log(111)
//            massive=[
//                [-3.0353810585678,9.4396586363085],[0,10],[2.9578850833057,9.6893780588866],[5.0805001752192,8.4407809459963],[6.3290972881095,6.3181658540828],[6.5788167106876,3.6961119170131],[5.3302195977972,1.9480759589667],[3.8319030623289,-0.0496794216578],[1.3347088365483,0.0751802896313],[-1.2873451005214,-0.0496794216578],[-4.2839781714581,0.8243385573654],[-4.4088378827471,3.5712522057241],[-4.4088378827471,6.8176046992389],[-4.4088378827471,-2.5468736474384],[-5.5828558617703,9.1899392137304],[-4.4088378827471,-5.418647007086],[-4.4088378827471,-8.2904203667337],[-2.5359422134117,-9.9135966134911],[0,-10],[2.4584462381495,-9.9135966134911],[4.9556404639301,-8.9147189231789],[6.9533958445546,-4.5446290280628],
//                [6.8285361332656,-7.0418232538434],[5.5799390203753,-2.0474348022822]
//            ]
//            k=0.03
//            for(var con=0; con<massive.length; con++){
//                objs.push(new Objects([massive[con][0]*10, massive[con][1]*10, 0],
//                                      [k*1.4*(massive[con][0]*10),k*(massive[con][1]*10),k*1.4/2*(massive[con][0]*10)+k/2*(massive[con][1]*10)],
//                                      [7000, 1, "#00d821"], ""+con, "planet"))
//            }
//            objs[5].mass=100000
//            objs[10].mass=100000
//            objs[20].mass=100000
            
            
            //267?-413.75195749173866;786.1858715675966;186.31429106828182;1.4238511192057437;-2.4108512435189353;-0.6121306206178726;7000;1;#00d821;0;planet---7.057717843614542;867.3319271345246;407.48779501510404;-0.03335259133994405;-2.7161347325218834;-1.4538483198885341;7000;1;#00d821;1;planet---392.3771068840204;815.1926461674765;567.0325357627814;-1.331680163199493;-2.516907236920139;-2.028677159323454;7000;1;#00d821;2;planet---600.7284756079895;698.6612995806147;624.4861809132619;-1.959112537909287;-2.1322159984459033;-2.2101609169126935;7000;1;#00d821;3;planet---713.3711098557835;548.9663366218698;609.1907560753244;-2.2613625986487;-1.7326332196858913;-2.157454029192698;7000;1;#00d821;4;planet---716.932678816805;305.8530490626377;506.7651647830836;-2.2630755761494146;-0.9437308134467732;-1.7779393155418401;7000;1;#00d821;5;planet---641.4184434821041;170.5009644701457;389.4367165618194;-2.098020143513203;-0.5478661948232231;-1.4003339073578724;7000;1;#00d821;6;planet---500.0768324318943;-5.111122012074216;229.36457595613837;-1.6939941331560588;0.030056752784593906;-0.8368025417808925;7000;1;#00d821;7;planet---185.49862977284835;4.314816109986495;85.9477481306078;-0.6335291009300792;-0.011751520088890808;-0.3149704022623527;7000;1;#00d821;8;planet----150.48349452897548;3.7223470105733516;-73.52488362426791;0.49479417167871165;-0.022828737684989196;0.26238024006598265;7000;1;#00d821;9;planet----469.06311198841274;93.87146350526922;-195.42247743605787;1.4902552673215215;-0.33076501901015987;0.6744401726669074;7000;1;#00d821;10;planet----503.19137246577816;289.44798751434763;-106.88665395785829;1.608724831057186;-0.869256629520622;0.38688252536293544;7000;1;#00d821;11;planet----542.4241100030349;699.244836295211;52.16514628961139;1.918549762482058;-2.713579658965056;-0.40413816283475873;7000;1;#00d821;12;planet----497.7443876334069;-238.26243284549216;-352.4022541914054;1.5928234741121734;0.7731843638371306;1.2565423090262937;7000;1;#00d821;13;planet----545.9833788362704;711.8970681604482;60.645948260433315;1.5182295246560749;-1.6661942999077974;0.0031926399750075406;7000;1;#00d821;14;planet----504.1835283536465;-488.957139602453;-470.7670398873041;1.611863004485654;1.5596364579120536;1.6779624043934702;7000;1;#00d821;15;planet----457.1537016981248;-719.9156033491893;-571.4409906647991;1.4059970490685036;2.2595745825372324;2.0103726004223827;7000;1;#00d821;16;planet----308.1193401466931;-827.703369173686;-545.4053240959165;1.0349208899646842;2.541403535658886;1.9419446142984642;7000;1;#00d821;17;planet---7.097724050254515;-874.9888654238857;-407.6041469205216;-0.025380156542653257;2.745300133797702;1.4521587806640428;7000;1;#00d821;18;planet---285.4767088908948;-861.2806006580173;-266.2042271057624;-0.9179029753025094;2.6991327386057438;0.9514273160420487;7000;1;#00d821;19;planet---595.6323906241948;-758.216992016038;-75.46403868661653;-1.9450811889755157;2.353302559472735;0.2587875907691937;7000;1;#00d821;20;planet---792.4219549581663;-438.79573178949306;190.3432867386699;-2.5389297815683816;1.4498252674800023;-0.6379116595064818;7000;1;#00d821;21;planet---789.9589212184234;-563.9427685710773;111.66572488173892;-2.54514217100882;1.6739870861570374;-0.4278254776728026;7000;1;#00d821;22;planet---638.5477637040578;-141.62040931407324;237.0289134788167;-2.0367082706752595;0.38872665564466036;-0.8475366327473695;7000;1;#00d821;23;planet---
            
            //main loop
            additional_fl=true
            
            dx=5
            function render() {
                
	            requestAnimationFrame(render);
                
                if(setting.start || additional_fl){
                    time+=1
                    if(time==STOP_TIME){
                        setting.start=false
                        start_button.name("start")
                        alert("Fryeburg Academy\nRaider")
                    }
                    additional_fl=false
                    objs_copy=objs
                for(i=0; i<objs.length; i++){
                    for(j=0; j<objs.length; j++){
                        if(i!=j){
                            distant_x=objs[i].coord_[0]-objs[j].coord_[0]
                            distant_y=objs[i].coord_[1]-objs[j].coord_[1]
                            distant_z=objs[i].coord_[2]-objs[j].coord_[2]
                            
                            distant=Math.sqrt(distant_x*distant_x+distant_y*distant_y+distant_z*distant_z)
                            
                            if(distant<=dx){
                                objs[i].accel=[0,0,0]
                            }
                            else{
                            objs[i].accel[0]+=-distant_x/(distant*distant*distant)*g*(objs[j].params[0])
                            objs[i].accel[1]+=-distant_y/(distant*distant*distant)*g*(objs[j].params[0])
                            objs[i].accel[2]+=-distant_z/(distant*distant*distant)*g*(objs[j].params[0])
                            }
                            
                        }
                    }
                    for(dim=0; dim<3; dim++){
                        objs[i].velocity[dim]=objs[i].velocity_[dim]+objs[i].accel[dim]
                        objs[i].coord[dim]=objs[i].coord[dim]+(objs[i].velocity[dim]+objs[i].velocity_[dim])/2
                    }
                }
                }
                for(i=0; i<objs.length; i++){
                    objs[i].obj.position.x=objs[i].coord[0]
                    objs[i].obj.position.y=objs[i].coord[1]
                    objs[i].obj.position.z=objs[i].coord[2]
                    
                    scene.remove(objs[i].line)
                    if(objs[i].toTrace=='true'){
                        objs[i].points.push( new THREE.Vector3(objs[i].coord[0],objs[i].coord[1],objs[i].coord[2]))
                        materialLine = new THREE.LineBasicMaterial({
	                       color: new THREE.Color(setting.general_light)
                        });
                        geometry = new THREE.BufferGeometry().setFromPoints( objs[i].points );
                        objs[i].line = new THREE.Line( geometry, materialLine );
                        scene.add(objs[i].line);
                    }
                }
                           
                confirm(objs)
                
                
	           renderer.render(scene, camera)
            }
            render()
		</script>
	</body>
</html>